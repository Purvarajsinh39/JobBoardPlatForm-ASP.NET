<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - Job Board Platform</title>

    <!-- ✅ TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    @RenderSection("Styles", required: false)
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
    <!-- ✅ Navbar -->
    <nav class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <!-- Logo -->
                <div class="flex-shrink-0 flex items-center">
                    <a href="@Url.Action("Index","Home")" class="text-xl font-bold text-indigo-600">JobBoard</a>
                </div>

                <!-- Links -->
                <div class="hidden sm:flex sm:space-x-6 items-center">
                    @if (Session["UserRole"] != null)
                    {
                        if (Session["UserRole"].ToString() == "Employer")
                        {
                            <a href="@Url.Action("Dashboard","Employer")" class="text-gray-700 hover:text-indigo-600 flex items-center">
                                <i data-feather="home" class="mr-1 w-4 h-4"></i> Dashboard
                            </a>
                            <a href="@Url.Action("ManageJobs","Employer")" class="text-gray-700 hover:text-indigo-600 flex items-center">
                                <i data-feather="briefcase" class="mr-1 w-4 h-4"></i> Manage Jobs
                            </a>
                            <a href="@Url.Action("CreateJob","Employer")" class="text-gray-700 hover:text-indigo-600 flex items-center">
                                <i data-feather="plus-circle" class="mr-1 w-4 h-4"></i> Post Job
                            </a>
                            <a href="@Url.Action("ShortlistedCandidates","Employer")" class="text-gray-700 hover:text-indigo-600 flex items-center">
                                <i data-feather="star" class="mr-1 w-4 h-4"></i> Shortlisted
                            </a>
                            <a href="@Url.Action("ViewProfile","Employer")" class="text-gray-700 hover:text-indigo-600 flex items-center">
                                <i data-feather="user" class="mr-1 w-4 h-4"></i> My Profile
                            </a>
                            <a href="@Url.Action("ViewAllApplications","Employer")" class="text-gray-700 hover:text-indigo-600 flex items-center">
                                <i data-feather="file-text" class="mr-1 w-4 h-4"></i> Applications
                            </a>
                        }
                        else if (Session["UserRole"].ToString() == "JobSeeker")
                        {
                            <a href="@Url.Action("Dashboard","JobSeeker")" class="text-gray-700 hover:text-indigo-600 flex items-center">
                                <i data-feather="search" class="mr-1 w-4 h-4"></i> Browse Jobs
                            </a>
                            <a href="@Url.Action("MyApplications","JobSeeker")" class="text-gray-700 hover:text-indigo-600 flex items-center">
                                <i data-feather="file-text" class="mr-1 w-4 h-4"></i> My Applications
                            </a>
                            <a href="@Url.Action("EditProfile","JobSeeker")" class="text-gray-700 hover:text-indigo-600 flex items-center">
                                <i data-feather="user" class="mr-1 w-4 h-4"></i> My Profile
                            </a>
                        }
                        else if (Session["UserRole"].ToString() == "Admin")
                        {
                            <a href="@Url.Action("Dashboard","Admin")" class="text-gray-700 hover:text-indigo-600 flex items-center">
                                <i data-feather="settings" class="mr-1 w-4 h-4"></i> Admin Panel
                            </a>
                            <a href="@Url.Action("Applications","Admin")" class="text-gray-700 hover:text-indigo-600 flex items-center">
                                <i data-feather="inbox" class="mr-1 w-4 h-4"></i> Applications
                            </a>
                            <a href="@Url.Action("ViewApplications","Admin")" class="text-gray-700 hover:text-indigo-600 flex items-center">
                                <i data-feather="list" class="mr-1 w-4 h-4"></i> All Applications
                            </a>
                            <a href="@Url.Action("ManageJobs","Admin")" class="text-gray-700 hover:text-indigo-600 flex items-center">
                                <i data-feather="briefcase" class="mr-1 w-4 h-4"></i> Manage Jobs
                            </a>
                            <a href="@Url.Action("ViewEmployers","Admin")" class="text-gray-700 hover:text-indigo-600 flex items-center">
                                <i data-feather="users" class="mr-1 w-4 h-4"></i> Employers
                            </a>
                            <a href="@Url.Action("ManageJobSeekers","Admin")" class="text-gray-700 hover:text-indigo-600 flex items-center">
                                <i data-feather="users" class="mr-1 w-4 h-4"></i> Job Seekers
                            </a>
                        }

                        <!-- ✅ Notification Bell -->
                <div class="relative">
                    <a href="#" class="text-gray-700 hover:text-indigo-600 flex items-center ml-4" id="notifDropdown">
                        <i data-feather="bell" class="w-5 h-5"></i>
                        <span id="notifCount" class="absolute -top-1 -right-2 bg-red-600 text-white text-xs rounded-full px-1">
                            @Html.Raw(ViewBag.UnreadNotificationCount ?? "0")
                        </span>
                    </a>

                    <!-- Dropdown -->
                    <div id="notifMenu" class="hidden absolute right-0 mt-2 w-64 bg-white shadow-lg rounded-lg overflow-hidden z-50">
                        <ul>
                            @if (ViewBag.Notifications != null)
                            {
                                foreach (var notif in ViewBag.Notifications)
                                {
                                    <li class="px-4 py-2 border-b hover:bg-gray-100">
                                        <a href="@Url.Action("MarkNotificationAsRead", "JobSeeker", new { id = notif.Id })" class="block">
                                            @notif.Message
                                            <span class="text-xs text-gray-400 block">@notif.CreatedAt.ToString("dd-MM-yyyy HH:mm")</span>
                                        </a>
                                    </li>
                                }
                            }
                            else
                            {
                                <li class="px-4 py-2 text-gray-500">No notifications</li>
                            }
                        </ul>
                    </div>

                </div>

                        <a href="@Url.Action("Logout","Account")" class="text-red-600 hover:text-red-800 flex items-center ml-4">
                            <i data-feather="log-out" class="mr-1 w-4 h-4"></i> Logout
                        </a>
                    }
                    else
                    {
                        <a href="@Url.Action("Login","Account")" class="text-gray-700 hover:text-indigo-600 flex items-center">
                            <i data-feather="log-in" class="mr-1 w-4 h-4"></i> Login
                        </a>
                        <a href="@Url.Action("Register","Account")" class="text-gray-700 hover:text-indigo-600 flex items-center">
                            <i data-feather="user-plus" class="mr-1 w-4 h-4"></i> Register
                        </a>
                    }
                </div>
            </div>
        </div>
    </nav>

    <!-- ✅ Page Body -->
    <div class="flex-grow">
        @RenderBody()
        @if (Session["UserName"] != null)
        {
            <div class="max-w-7xl mx-auto px-4 mt-4 text-gray-600">
                Welcome, <strong>@Session["UserName"]</strong>!
            </div>
        }
    </div>

    <!-- ✅ Footer -->
    <footer class="bg-white border-t py-4 mt-8 text-center text-gray-500">
        <p>&copy; @DateTime.Now.Year - Job Board Platform</p>
    </footer>

    <!-- ✅ Scripts -->
    <script>
        feather.replace();

        // Notification dropdown toggle
        document.addEventListener('DOMContentLoaded', function () {
            const dropdown = document.getElementById('notifDropdown');
            const menu = document.getElementById('notifMenu');

            dropdown.addEventListener('click', function (e) {
                e.preventDefault();
                menu.classList.toggle('hidden');
            });

            // Close dropdown if clicked outside
            document.addEventListener('click', function (e) {
                if (!dropdown.contains(e.target) && !menu.contains(e.target)) {
                    menu.classList.add('hidden');
                }
            });
        });
    </script>
    @RenderSection("scripts", required: false)
</body>
</html>
